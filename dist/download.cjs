Object.defineProperty(exports,Symbol.toStringTag,{value:`Module`});var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},s=(n,r,a)=>(a=n==null?{}:e(i(n)),o(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));const c=require(`./info-D6eY7rX5.cjs`);let l=require(`m3u8stream`);l=s(l);const u=async(e,t,n)=>{let r=await n.get(c.a(e,`client_id`,t),{headers:{"User-Agent":`Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.52 Safari/537.36`,Accept:`*/*`,"Accept-Encoding":`gzip, deflate, br`},withCredentials:!0});if(!r.data.url)throw Error(`Invalid response from Soundcloud. Check if the URL provided is correct: ${e}`);return r.data.url},d=async(e,t)=>(await t.get(e,{withCredentials:!0,responseType:`stream`})).data,f=e=>(0,l.default)(e),p=async(e,t,n,r,i,a)=>{try{let o=await n(e,t,a);return e.includes(`/progressive`)?await r(o,a):i(o)}catch(e){throw c.o(e)}},m=async(e,t,n)=>await p(e,t,u,d,f,n),h=async(e,t,n,r,i,a,o)=>{if(!v(e))throw Error(`Invalid media object provided`);return await a(e.url,t,o)},g=async(e,t,n)=>await h(e,t,u,d,f,m,n),_=async(e,t,n)=>{let{data:{redirectUri:r}}=await n.get(c.a(`https://api-v2.soundcloud.com/tracks/${e}/download`,`client_id`,t)),{data:i}=await n.get(r,{responseType:`stream`});return i},v=e=>!(!e||!e.url||!e.format||!e.format.protocol||![`hls`,`progressive`].includes(e.format.protocol)),y=async(e,t,n,r=!0)=>{let i=await c.t(e,t,n);if(i.downloadable&&r)try{return await _(i.id,t,n)}catch{console.log(`Download link failed, trying transcoding...`)}let a=i.media.transcodings.filter(e=>v(e)&&e.url&&e.format&&(e.format.protocol===`hls`||e.format.protocol===`progressive`));if(a.length===0)throw Error(`No valid transcoding available for this track`);a.find(e=>e.format.protocol===`progressive`)||a[0];for(let e=0;e<a.length;e++){let r=a[e];try{return await g(r,t,n)}catch(t){if(console.log(`Transcoding failed: ${r.format.protocol}, trying next...`),e===a.length-1)throw t}}};exports.download=y,exports.fromDownloadLink=_,exports.fromMediaObj=g,exports.fromMediaObjBase=h,exports.fromURL=m,exports.fromURLBase=p,exports.getHLSStream=f,exports.getMediaURL=u,exports.getProgressiveStream=d,exports.t=s;
//# sourceMappingURL=download.cjs.map